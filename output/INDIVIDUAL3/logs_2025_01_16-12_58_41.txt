{'dataset': 'INDIVIDUAL3', 'group': '1-1', 'lookback': 672, 'normalize': False, 'spec_res': False, 'kernel_size': 7, 'use_gatv2': True, 'feat_gat_embed_dim': None, 'time_gat_embed_dim': None, 'gru_n_layers': 1, 'gru_hid_dim': 150, 'fc_n_layers': 3, 'fc_hid_dim': 150, 'recon_n_layers': 1, 'recon_hid_dim': 150, 'alpha': 0.2, 'epochs': 10, 'val_split': 0.1, 'bs': 32, 'init_lr': 0.001, 'shuffle_dataset': True, 'dropout': 0.3, 'use_cuda': False, 'print_every': 1, 'log_tensorboard': True, 'scale_scores': False, 'use_mov_av': False, 'gamma': 1, 'level': None, 'q': None, 'dynamic_pot': False, 'comment': ''}
load data of: INDIVIDUAL3
train:  0 None
test:  0 None
train set shape:  (35220, 4)
test set shape:  (8806, 4)
test set label shape:  None
Training data shape: (35220, 4), Test data shape: (8806, 4)
Number of features: 4, Window size: 672
Will forecast and reconstruct all 4 input features
train_size: 31094
validation_size: 3454
test_size: 8134
Training batches: 972, Validation batches: 108, Test batches: 255
Init total train loss: 0.801597
Init total val loss: 0.80290
Training model for 10 epochs..
[Epoch 1] forecast_loss = 0.08900, recon_loss = 0.11044, total_loss = 0.19944 ---- val_forecast_loss = 0.04393, val_recon_loss = 0.07810, val_total_loss = 0.12203 [4389.4s]
[Epoch 2] forecast_loss = 0.04923, recon_loss = 0.07066, total_loss = 0.11989 ---- val_forecast_loss = 0.02932, val_recon_loss = 0.06509, val_total_loss = 0.09441 [3234.6s]
[Epoch 3] forecast_loss = 0.04223, recon_loss = 0.06253, total_loss = 0.10476 ---- val_forecast_loss = 0.02583, val_recon_loss = 0.05853, val_total_loss = 0.08436 [3172.1s]
[Epoch 4] forecast_loss = 0.03956, recon_loss = 0.05604, total_loss = 0.09560 ---- val_forecast_loss = 0.02633, val_recon_loss = 0.05268, val_total_loss = 0.07901 [3012.6s]
[Epoch 5] forecast_loss = 0.03824, recon_loss = 0.05246, total_loss = 0.09070 ---- val_forecast_loss = 0.02411, val_recon_loss = 0.05123, val_total_loss = 0.07534 [3141.8s]
[Epoch 6] forecast_loss = 0.03730, recon_loss = 0.04977, total_loss = 0.08708 ---- val_forecast_loss = 0.02464, val_recon_loss = 0.04746, val_total_loss = 0.07210 [3170.8s]
[Epoch 7] forecast_loss = 0.03659, recon_loss = 0.04920, total_loss = 0.08579 ---- val_forecast_loss = 0.02303, val_recon_loss = 0.04729, val_total_loss = 0.07031 [2997.5s]
[Epoch 8] forecast_loss = 0.03610, recon_loss = 0.04499, total_loss = 0.08109 ---- val_forecast_loss = 0.02553, val_recon_loss = 0.04426, val_total_loss = 0.06979 [3045.4s]
[Epoch 9] forecast_loss = 0.03551, recon_loss = 0.04327, total_loss = 0.07878 ---- val_forecast_loss = 0.02228, val_recon_loss = 0.04327, val_total_loss = 0.06555 [2990.0s]
[Epoch 10] forecast_loss = 0.03514, recon_loss = 0.04099, total_loss = 0.07613 ---- val_forecast_loss = 0.02155, val_recon_loss = 0.04039, val_total_loss = 0.06194 [3050.7s]
-- Training done in 32204s.
Starting training...
Training completed.
Starting evaluation on test data...
Test forecast loss: 0.04605
Test reconstruction loss: 0.10829
Test total loss: 0.15434
Predicting and calculating anomaly scores..
  0%|          | 0/135 [00:00<?, ?it/s]  1%|          | 1/135 [00:12<27:23, 12.27s/it]  1%|▏         | 2/135 [00:24<26:48, 12.09s/it]  2%|▏         | 3/135 [00:36<26:22, 11.99s/it]  3%|▎         | 4/135 [00:47<25:44, 11.79s/it]  4%|▎         | 5/135 [00:58<25:14, 11.65s/it]  4%|▍         | 6/135 [01:10<24:51, 11.56s/it]  5%|▌         | 7/135 [01:22<24:57, 11.70s/it]  6%|▌         | 8/135 [01:34<24:51, 11.75s/it]  7%|▋         | 9/135 [01:45<24:28, 11.65s/it]  7%|▋         | 10/135 [01:57<24:32, 11.78s/it]  8%|▊         | 11/135 [02:09<24:36, 11.91s/it]  9%|▉         | 12/135 [02:22<24:35, 11.99s/it] 10%|▉         | 13/135 [02:33<24:09, 11.88s/it] 10%|█         | 14/135 [02:45<23:37, 11.72s/it] 11%|█         | 15/135 [02:56<23:16, 11.64s/it] 12%|█▏        | 16/135 [03:08<23:14, 11.72s/it] 13%|█▎        | 17/135 [03:20<23:14, 11.82s/it] 13%|█▎        | 18/135 [03:31<22:44, 11.66s/it] 14%|█▍        | 19/135 [03:43<22:28, 11.63s/it] 15%|█▍        | 20/135 [03:54<22:08, 11.55s/it] 16%|█▌        | 21/135 [04:06<21:50, 11.50s/it] 16%|█▋        | 22/135 [04:17<21:44, 11.55s/it] 17%|█▋        | 23/135 [04:29<21:32, 11.54s/it] 18%|█▊        | 24/135 [04:41<21:35, 11.67s/it] 19%|█▊        | 25/135 [04:53<21:37, 11.79s/it] 19%|█▉        | 26/135 [05:05<21:40, 11.93s/it] 20%|██        | 27/135 [05:17<21:40, 12.04s/it] 21%|██        | 28/135 [05:30<21:31, 12.07s/it] 21%|██▏       | 29/135 [05:42<21:28, 12.16s/it] 22%|██▏       | 30/135 [05:54<21:23, 12.23s/it] 23%|██▎       | 31/135 [06:07<21:14, 12.25s/it] 24%|██▎       | 32/135 [06:18<20:44, 12.08s/it] 24%|██▍       | 33/135 [06:30<20:16, 11.92s/it] 25%|██▌       | 34/135 [06:41<19:53, 11.82s/it] 26%|██▌       | 35/135 [06:53<19:37, 11.78s/it] 27%|██▋       | 36/135 [07:05<19:25, 11.77s/it] 27%|██▋       | 37/135 [07:17<19:24, 11.89s/it] 28%|██▊       | 38/135 [07:29<19:24, 12.01s/it] 29%|██▉       | 39/135 [07:41<19:18, 12.06s/it] 30%|██▉       | 40/135 [07:54<19:09, 12.10s/it] 30%|███       | 41/135 [08:06<19:01, 12.14s/it] 31%|███       | 42/135 [08:18<18:51, 12.17s/it] 32%|███▏      | 43/135 [08:30<18:43, 12.21s/it] 33%|███▎      | 44/135 [08:43<18:34, 12.25s/it] 33%|███▎      | 45/135 [08:55<18:22, 12.25s/it] 34%|███▍      | 46/135 [09:07<18:08, 12.23s/it] 35%|███▍      | 47/135 [09:19<17:52, 12.19s/it] 36%|███▌      | 48/135 [09:31<17:27, 12.04s/it] 36%|███▋      | 49/135 [09:42<17:01, 11.88s/it] 37%|███▋      | 50/135 [09:54<16:42, 11.80s/it] 38%|███▊      | 51/135 [10:06<16:38, 11.88s/it] 39%|███▊      | 52/135 [10:18<16:31, 11.95s/it] 39%|███▉      | 53/135 [10:30<16:26, 12.03s/it] 40%|████      | 54/135 [10:43<16:20, 12.10s/it] 41%|████      | 55/135 [10:55<16:03, 12.04s/it] 41%|████▏     | 56/135 [11:06<15:37, 11.87s/it] 42%|████▏     | 57/135 [11:18<15:24, 11.85s/it] 43%|████▎     | 58/135 [11:29<15:03, 11.73s/it] 44%|████▎     | 59/135 [11:41<14:41, 11.60s/it] 44%|████▍     | 60/135 [11:52<14:22, 11.50s/it] 45%|████▌     | 61/135 [12:03<14:06, 11.44s/it] 46%|████▌     | 62/135 [12:15<13:53, 11.42s/it] 47%|████▋     | 63/135 [12:26<13:47, 11.50s/it] 47%|████▋     | 64/135 [12:38<13:34, 11.47s/it] 48%|████▊     | 65/135 [12:49<13:20, 11.43s/it] 49%|████▉     | 66/135 [13:01<13:12, 11.48s/it] 50%|████▉     | 67/135 [13:12<12:54, 11.39s/it] 50%|█████     | 68/135 [13:23<12:42, 11.38s/it] 51%|█████     | 69/135 [13:35<12:36, 11.46s/it] 52%|█████▏    | 70/135 [13:46<12:21, 11.41s/it] 53%|█████▎    | 71/135 [13:57<12:04, 11.32s/it] 53%|█████▎    | 72/135 [14:09<11:54, 11.35s/it] 54%|█████▍    | 73/135 [14:20<11:41, 11.31s/it] 55%|█████▍    | 74/135 [14:31<11:29, 11.31s/it] 56%|█████▌    | 75/135 [14:43<11:18, 11.31s/it] 56%|█████▋    | 76/135 [14:54<11:10, 11.36s/it] 57%|█████▋    | 77/135 [15:06<11:01, 11.41s/it] 58%|█████▊    | 78/135 [15:17<10:54, 11.48s/it] 59%|█████▊    | 79/135 [15:28<10:38, 11.41s/it] 59%|█████▉    | 80/135 [15:40<10:25, 11.38s/it] 60%|██████    | 81/135 [15:51<10:19, 11.47s/it] 61%|██████    | 82/135 [16:03<10:07, 11.46s/it] 61%|██████▏   | 83/135 [16:14<09:57, 11.49s/it] 62%|██████▏   | 84/135 [16:26<09:49, 11.56s/it] 63%|██████▎   | 85/135 [16:37<09:34, 11.50s/it] 64%|██████▎   | 86/135 [16:49<09:17, 11.38s/it] 64%|██████▍   | 87/135 [17:00<09:04, 11.34s/it] 65%|██████▌   | 88/135 [17:11<08:49, 11.27s/it] 66%|██████▌   | 89/135 [17:22<08:37, 11.24s/it] 67%|██████▋   | 90/135 [17:33<08:26, 11.26s/it] 67%|██████▋   | 91/135 [17:45<08:15, 11.26s/it] 68%|██████▊   | 92/135 [17:56<08:03, 11.24s/it] 69%|██████▉   | 93/135 [18:07<07:53, 11.27s/it] 70%|██████▉   | 94/135 [18:18<07:42, 11.28s/it] 70%|███████   | 95/135 [18:30<07:33, 11.35s/it] 71%|███████   | 96/135 [18:41<07:22, 11.35s/it] 72%|███████▏  | 97/135 [18:53<07:10, 11.33s/it] 73%|███████▎  | 98/135 [19:04<06:58, 11.32s/it] 73%|███████▎  | 99/135 [19:15<06:47, 11.33s/it] 74%|███████▍  | 100/135 [19:27<06:38, 11.37s/it] 75%|███████▍  | 101/135 [19:38<06:27, 11.39s/it] 76%|███████▌  | 102/135 [19:50<06:15, 11.39s/it] 76%|███████▋  | 103/135 [20:01<06:05, 11.44s/it] 77%|███████▋  | 104/135 [20:12<05:53, 11.39s/it] 78%|███████▊  | 105/135 [20:24<05:43, 11.44s/it] 79%|███████▊  | 106/135 [20:35<05:30, 11.38s/it] 79%|███████▉  | 107/135 [20:47<05:18, 11.37s/it] 80%|████████  | 108/135 [20:58<05:06, 11.34s/it] 81%|████████  | 109/135 [21:10<04:57, 11.44s/it] 81%|████████▏ | 110/135 [21:21<04:47, 11.51s/it] 82%|████████▏ | 111/135 [21:33<04:36, 11.51s/it] 83%|████████▎ | 112/135 [21:44<04:25, 11.54s/it] 84%|████████▎ | 113/135 [21:56<04:12, 11.48s/it] 84%|████████▍ | 114/135 [22:07<03:59, 11.42s/it] 85%|████████▌ | 115/135 [22:18<03:49, 11.46s/it] 86%|████████▌ | 116/135 [22:30<03:38, 11.50s/it] 87%|████████▋ | 117/135 [22:41<03:26, 11.48s/it] 87%|████████▋ | 118/135 [22:53<03:14, 11.44s/it] 88%|████████▊ | 119/135 [23:04<03:02, 11.40s/it] 89%|████████▉ | 120/135 [23:15<02:50, 11.38s/it] 90%|████████▉ | 121/135 [23:27<02:39, 11.38s/it] 90%|█████████ | 122/135 [23:38<02:27, 11.34s/it] 91%|█████████ | 123/135 [23:50<02:16, 11.39s/it] 92%|█████████▏| 124/135 [24:01<02:05, 11.45s/it] 93%|█████████▎| 125/135 [24:13<01:55, 11.57s/it] 93%|█████████▎| 126/135 [24:24<01:43, 11.49s/it] 94%|█████████▍| 127/135 [24:36<01:31, 11.39s/it] 95%|█████████▍| 128/135 [24:47<01:20, 11.43s/it] 96%|█████████▌| 129/135 [24:58<01:08, 11.41s/it] 96%|█████████▋| 130/135 [25:10<00:57, 11.42s/it] 97%|█████████▋| 131/135 [25:21<00:45, 11.42s/it] 98%|█████████▊| 132/135 [25:33<00:34, 11.42s/it] 99%|█████████▊| 133/135 [25:44<00:22, 11.42s/it] 99%|█████████▉| 134/135 [25:56<00:11, 11.47s/it]100%|██████████| 135/135 [26:07<00:00, 11.32s/it]100%|██████████| 135/135 [26:07<00:00, 11.61s/it]
Predicting and calculating anomaly scores..
  0%|          | 0/32 [00:00<?, ?it/s]  3%|▎         | 1/32 [00:11<05:42, 11.04s/it]  6%|▋         | 2/32 [00:22<05:32, 11.08s/it]  9%|▉         | 3/32 [00:33<05:21, 11.09s/it] 12%|█▎        | 4/32 [00:44<05:11, 11.13s/it] 16%|█▌        | 5/32 [00:55<05:00, 11.15s/it] 19%|█▉        | 6/32 [01:06<04:49, 11.14s/it] 22%|██▏       | 7/32 [01:17<04:38, 11.13s/it] 25%|██▌       | 8/32 [01:29<04:27, 11.15s/it] 28%|██▊       | 9/32 [01:40<04:16, 11.15s/it] 31%|███▏      | 10/32 [01:51<04:05, 11.16s/it] 34%|███▍      | 11/32 [02:02<03:55, 11.20s/it] 38%|███▊      | 12/32 [02:14<03:44, 11.24s/it] 41%|████      | 13/32 [02:25<03:33, 11.26s/it] 44%|████▍     | 14/32 [02:36<03:22, 11.24s/it] 47%|████▋     | 15/32 [02:47<03:09, 11.17s/it] 50%|█████     | 16/32 [02:58<02:58, 11.14s/it] 53%|█████▎    | 17/32 [03:09<02:46, 11.11s/it] 56%|█████▋    | 18/32 [03:20<02:34, 11.06s/it] 59%|█████▉    | 19/32 [03:31<02:24, 11.08s/it] 62%|██████▎   | 20/32 [03:42<02:12, 11.07s/it] 66%|██████▌   | 21/32 [03:53<02:01, 11.05s/it] 69%|██████▉   | 22/32 [04:04<01:50, 11.08s/it] 72%|███████▏  | 23/32 [04:15<01:39, 11.05s/it] 75%|███████▌  | 24/32 [04:26<01:28, 11.04s/it] 78%|███████▊  | 25/32 [04:37<01:17, 11.05s/it] 81%|████████▏ | 26/32 [04:48<01:06, 11.04s/it] 84%|████████▍ | 27/32 [04:59<00:55, 11.03s/it] 88%|████████▊ | 28/32 [05:11<00:44, 11.04s/it] 91%|█████████ | 29/32 [05:22<00:33, 11.12s/it] 94%|█████████▍| 30/32 [05:33<00:22, 11.27s/it] 97%|█████████▋| 31/32 [05:45<00:11, 11.36s/it]100%|██████████| 32/32 [05:55<00:00, 10.83s/it]100%|██████████| 32/32 [05:55<00:00, 11.10s/it]
Running POT with q=0.001, level=0.95..
Initial threshold : 0.0856642
Number of peaks : 1727
Grimshaw maximum log-likelihood estimation ... [done]
	γ = -0.008848839439451694
	σ = 0.020832371337489747
	L = 4973.9257863186085
Extreme quantile (probability = 0.001): 0.16576180972553817
  0%|          | 0/8134 [00:00<?, ?it/s]100%|██████████| 8134/8134 [00:00<00:00, 2703151.00it/s]
0
8134
Results using epsilon method:
 {'threshold': 0.10956648364663124, 'reg_level': 0}
Results using peak-over-threshold method:
 {'threshold': 0.16576180972553817}
Results using best f1 score search:
 {}
Saving output to output/INDIVIDUAL3/16012025_125843/<train/test>_output.pkl
-- Done.
